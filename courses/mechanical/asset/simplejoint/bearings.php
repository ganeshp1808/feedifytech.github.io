<?php
error_reporting(0);
ini_set('display_errors', 'Off');
	$form_data=json_decode(file_get_contents("php://input"));
	$confirm_token=$_GET['token'];

	$submit_token=$form_data->token;
	$error=[];$data=[];$para=[];

	if(($submit_token===$confirm_token) and ($_SERVER['REQUEST_METHOD'] === 'POST')){
        if(($form_data->type)=="bear"){
            $fa=($form_data->sjkaM2k); $fr=($form_data->isDml7a); $rpm=($form_data->oalPt3y);  $wy=($form_data->jakQlo0); $wd=($form_data->lYix3ra); 
            $wh=($form_data->jakBnd2); $sf=($form_data->wknbx6S); $rb=($form_data->gdFks8a);
            $bdatap=[];
            $bdatap[]=$bearlife=($wy*$wd*$wh);//bearing life in hrs
            $bdatap[]=$lifemr=round((($bearlife*$rpm*60)/1000000),2); //life in million hrs 
            $bdatap[]=$lifermr=round(($lifemr*pow((log($rb*0.01)/log(0.9)),(1/1.34))),2);//life for certain reliability

            $sfl=[[0.025,0.22,2],[0.04,0.24,1.8],[0.07,0.27,1.6],[0.13,0.31,1.4],[0.25,0.37,1.2],[0.5,0.44,1]];     $itb=[];  $otb=[];
            $dgbb=[["6000",1900,3600],["6001",2200,4000],["6002",2550,4400],["6003",2850,4650],["6004",4500,7350],["6005",5200,7800],["6006",7100,10400],["6007",8800,12500],["6008",9800,13200],["6009",12700,16300],["6010",13700,17000],["6011",18000,22000],["6012",19300,22800],
                    ["6013",21200,24000],["6014",25500,30000],["6015",28000,31000],["6016",33500,37500],["6017",36000,39000],["6018",41500,45500],
                    ["6020",45000,47500],["6022",61000,64000],["6024",65500,67000],["6026",83000,83000],["6028",90000,86500],["6030",104000,98000],
                    ["6032",118000,112000],["6034",143000,132000],["6036",166000,150000],["6038",180000,153000],["6040",200000,170000],["6200",2240,4000],
                    ["6201",3000,5400],["6202",3550,6100],["6203",4400,7500],["6204",6550,10000],["6205",7100,11000],["6206",10000,15300],
                    ["6207",13700,20000],["6208",16000,22800],["6209",18300,25500],["6210",21200,27500],["6211",26000,34000],["6212",32000,40500],
                    ["6213",35500,44000],["6214",39000,48000],["6215",42500,52000],["6216",45500,57000],["6217",55000,65500],["6218",63000,75000],
                    ["6219",72000,85000],["6220",81500,96500],["6221",93000,104000],["6222",104000,112000],["6224",104000,114000],["6226",116000,122000],
                    ["6228",129000,129000],["6230",143000,137000],["6232",156000,143000],["6234",190000,166000],["6236",204000,176000],["6238",240000,200000],
                    ["6240",265000,212000],["6300",3600,6300],
                    ["6301",4300,7650],["6302",5200,8800],["6303",6300,10600],["6304",7650,12500],["6305",10400,16600],["6306",14600,22000],
                    ["6307",17600,26000],["6308",22000,32000],["6309",30000,41500],["6310",35500,48000],["6311",42500,56000],["6312",48000,64000],
                    ["6313",55000,72000],["6314",63000,81500],["6315",72000,90000],["6316",80000,96500],["6317",88000,104000],["6318",98000,112000],
                    ["6319",112000,120000],["6320",132000,137000],["6321",143000,143000],["6322",166000,160000],["6324",170000,163000],["6326",196000,180000],
                    ["6328",224000,200000],["6330",255000,216000],["6403",12800,18000],["6404",16600,24000],["6405",20000,28250],["6406",24000,33500],
                    ["6407",32500,43000],["6408",38000,50000],["6409",46500,58500],["6410",53000,70000],["6411",64000,78500],["6412",71000,84500],
                    ["6413",80000,91500],["6414",91000,100000],["6415",101600,120000],["6416",128000,130000],["6417",138000,138000],["6418",166000,152000]];
            for ($i = 0; $i < count($dgbb); $i++) {
                $x=0; $y=0;
                $fabco=($fa/$dgbb[$i][1]);
                for ($j = 0; $j < count($sfl); $j++) {
                    if($fabco>($sfl[$j][0])){
                        if(($fa/$fr)>$sfl[$j][1]){ $x=0.56; $y=$sfl[$j][2]; }
                        if(($fa/$fr)<$sfl[$j][1]){ $x=1; $y=0; }
                           break;
                        }
                    }
                    $peq1=((($x*$fr)+($y*$fa))*$sf);  
                    if($lifermr<(pow((($dgbb[$i][2])/$peq1),3))){
                        $itb[]=$dgbb[$i][0];
                    }
                    $peq2=((($x*1.2*$fr)+($y*$fa))*$sf);  
                    if($lifermr<(pow((($dgbb[$i][2])/$peq2),3))){
                       $otb[]=$dgbb[$i][0];
                }
            }
            if(count($itb)==0){ $itb[]="No bearing available"; }
            if(count($otb)==0){ $otb[] = "No bearing available"; } 
            $para["ahJs2w1"]=$bdatap;    $para["gsdh4Ks"]=$itb;     $para["Skco3kh"]=$otb;    $data["para"]=$para;
        }

        if(($form_data->type)=="BN"){
            $bt=($form_data->kaMzu8s); $btdata=[];
            if($bt<10){ $btdata[]="0".$bt; }else if($bt>=10){ $btdata[]=$bt; }
            if($bt==0){ $btdata[]=10; }else if($bt==1){ $btdata[]=12; }else if($bt==2){ $btdata[]=15; }else if($bt==3){ $btdata[]=17; }else if($bt>3){ $btdata[]=($bt*5); }
            $para["jaNzme3"]=$btdata; $data["para"]=$para;
        }
    echo json_encode($data);
}
?>